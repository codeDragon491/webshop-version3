<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <title>SHOPAHOLIC</title>
    <style>
        /**********************************************************/

        /*                      ALL THE CSS!                      */

        /**********************************************************/

        @font-face {
            font-family: Poppins-Light;
            src: url(css/Poppins-Light.ttf);
        }

        @font-face {
            font-family: Poppins-Regular;
            src: url(css/Poppins-Regular.ttf);
        }

        @font-face {
            font-family: Poppins-Medium;
            src: url(css/Poppins-Medium.ttf);
        }

        @font-face {
            font-family: Poppins-Semibold;
            src: url(css/Poppins-Semibold.ttf);
        }

        * {
            padding: 0;
            margin: 0;
            box-sizing: border-box;
        }

        body {
            width: 100vw;
            min-height: 100vh;
            display: flex;
            flex-flow: column nowrap;
        }

        header {
            width: 100vw;
            height: 100px;
            background-color: #da0883;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        footer {
            width: 100vw;
            height: 100px;
            background-color: #da0883;
            display: flex;
            align-items: center;
            margin-top: auto;
        }

        input,
        select#txtUpdateUserRole,
        select#txtCreateUserRole {
            width: 30%;
            height: 50px;
            font-family: Poppins-Regular;
            font-size: 14px;
            padding: 0 10px;
        }

        button {
            height: 50px;
            border: none;
            outline: none;
            cursor: pointer;
            font-family: Poppins-Medium;
            font-size: 14px;
            background-color: transparent;
        }

        p {
            font-family: Poppins-Regular;
            font-size: 14px;
        }

        h3 {
            font-family: Poppins-Light;
            font-weight: lighter;
        }

        /**********************************************************/

        /*                      ALL THE BUTTON STYLING            */

        /**********************************************************/

        input#txtSearchProducts {
            margin-right: 15%;
        }

        #btnViewProducts {
            margin-right: auto;
        }

        .btnHeader,
        .btnFooter {
            color: white;
            background-color: transparent;
        }

        .btnHorizontal {
            width: 10%;
        }

        #btnSignup,
        #btnLogin,
        .btnViewSubscriber {
            background-color: transparent;
        }

        #btnCreateProduct,
        #btnCreateUser {
            align-items: center;
            justify-content: center;
            display: none;
            margin: 20px;
            width: 10%;
            background-color: #da0883;
            color: white;
        }

        .btnForm {
            width: 30%;
            background-color: #A2BB49;
            color: white;
        }

        .btnEditProduct,
        .btnDeleteProduct,
        .btnBuyProduct,
        .btnEditUser,
        .btnDeleteUser {
            margin: 10px;
            width: 30%;
            background-color: #A2BB49;
            color: white;
        }

        #btnSubscribeNav {
            margin-right: auto;
            margin-left: auto;
        }

        /**********************************************************/

        /*                      ALL THE PAGES STYLING             */

        /**********************************************************/

        #lblProductList,
        #lblUserList,
        #lblSubscriberList {
            margin-top: 20px;
            width: 100vw;
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            justify-content: space-around;
        }

        .wrapper {
            width: 100%;
            display: flex;
            flex-direction: column;
        }

        .lblProduct,
        .lblUser,
        .lblSubscriber {
            margin-top: 20px;
            width: 30vw;
            display: flex;
            flex-direction: column;
            align-items: center;
            border: 2px solid lightgrey;
        }

        .popup {
            display: none;
            margin-top: 100px;
        }

        .page {
            margin-bottom: 100px;
        }

        #pageViewUsers {
            display: none;
        }

        /**********************************************************/

        /*                      LIGHTBOX STYLING                  */

        /**********************************************************/

        .lightbox {
            /** Default lightbox to hidden */
            display: none;

            /** Position and style */
            position: fixed;
            z-index: 999;
            width: 100%;
            height: 100%;
            text-align: center;
            top: 0;
            left: 0;
            background: rgba(0, 0, 0, 0.8);
        }

        .lightbox img {
            /** Pad the lightbox image */
            max-width: 100%;
            max-height: 90%;
            margin-top: 3%;
        }

        .lightbox:target {
            /** Remove default browser outline */
            outline: none;

            /** Unhide lightbox **/
            display: block;
        }

        .lblProduct a {
            text-align: center;
        }

        /**********************************************************/

        /*                      ALL THE FORM STYLING              */

        /**********************************************************/

        #frmSortBy {
            display: flex;
            align-items: center;
            margin-left: auto;
            padding: 20px;
        }

        select#slctProductSorter {
            height: 40px;
            font-family: Poppins-Medium;
            font-size: 14px;
            color: #A2BB49;
            margin-left: 20px;
        }

        .popup h3 {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: space-around;
        }

        #frmLogin,
        #frmCreateProduct {
            height: 22em;
        }

        #frmDeleteAccount {
            height: 13em;
        }

        #frmUpdateUser,
        #frmUpdateProduct {
            height: 35em;
        }

        #frmSubscribe {
            height: 45em;
        }

        .form {
            height: 30em;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: space-around;
        }

        .lblFormExtention {
            width: 30%;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .lblFileUpload {
            width: 30%;
            display: flex;
            align-items: center;
            justify-content: flex-start;
        }

        #txtUpdateProductImage {
            width: 10%;
        }

        select {
            background-color: white;
            border-color: lightgrey;
            border-radius: 0;
        }

        /**********************************************************/

        /*                      ALL THE DROPDOWN STYLING          */

        /**********************************************************/

        /* Style The Dropdown Button */

        #lblDropdown,
        #lblDropdownforMobileOnly {
            display: none;
            margin-right: 5%;
            flex-direction: column;
            justify-content: space-between;
            align-items: center;
        }

        .btnDropdown {
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 0px 20px 0px 20px;
        }

        /* Dropdown Content (Hidden by Default) */

        #lblDropdownContent,
        #lblDropdownContentforMobileOnly {
            display: none;
            position: absolute;
            margin-top: 2em;
            width: 11em;
            background-color: #da0883;
            /*#ff6600;*/
            ;
        }

        /* Show the dropdown menu on hover */

        #lblDropdown:hover #lblDropdownContent,
        #lblDropdownforMobileOnly:hover #lblDropdownContentforMobileOnly {
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            align-items: flex-start;
            height: 10em;
        }

        .fa-caret-down {
            font-size: 20px;
        }

        /**********************************************************/

        /*                      ALL THE ERROR MESSAGE STYLING     */

        /**********************************************************/

        #lblWelcomeUserMessage {
            margin-right: auto;
            color: white;
            font-family: Poppins-Regular;
        }

        .lblErrorMessage {
            align-self: center;
            width: 30%;
            color: red;
            font-weight: bolder;
        }

        /*.cPage{
            display: none;
        }
        
        .cPage.show{
            display: flex;
        }*/

        /**********************************************************/

        /*                      ALL THE MAP STYLING       */

        /**********************************************************/

        #map {
            margin: 100px 0 100px;
            height: 400px;
            width: 90%;
            align-self: center;
        }

        #mapinForm {
            height: 400px;
            width: 30%;
            align-self: center;
        }

        .fa-map-marker {
            font-size: 50px;
            color: #A2BB49;
        }

        /**********************************************************/

        /*                      ALL THE MOBILE DISPLAY STYLING    */

        /**********************************************************/

        @media only screen and (max-width:767px) {

            #btnLoginNav,
            #btnSignupNav {
                display: none;
            }

            #lblDropdownforMobileOnly {
                display: flex;
            }

            #lblDropdownforMobileOnly,
            #lblDropdown {
                margin-right: 0;
            }

            .lblProduct,
            .lblUser,
            .lblSubscriber {
                width: 90vw;
            }

            #logo {
                width: 30vw;
            }

            .btnEditProduct,
            .btnDeleteProduct,
            .btnBuyProduct,
            .btnEditUser,
            .btnDeleteUser,
            #btnCreateProduct,
            #btnCreateUser {
                width: 50%;
            }

            input,
            .btnForm,
            .lblFormExtention,
            .lblFileUpload,
            #mapinForm,
            select#txtUpdateUserRole,
            select#txtCreateUserRole,
                {
                width: 90%;
            }

            #mapinForm {
                height: 300px;
            }

            #lblDropdown:hover #lblDropdownContent {
                height: 15em;
            }

            #lblDropdownforMobileOnly:hover #lblDropdownContentforMobileOnly {
                height: 5em;
                width: 6em;
            }

            .btnDropdown {
                padding-top: 10px;
            }

            #lblDropdownContent,
            #lblDropdownContentforMobileOnly {
                right: 3%;
            }

            #lblWelcomeUserMessage {
                display: none;
            }

            input#txtSearchProducts {
                margin-right: auto;
                margin-left: auto;
            }
        }

        /**********************************************************/

        /*                      ALL THE TABLET DISPLAY STYLING    */

        /**********************************************************/

        @media only screen and (min-width:768px) and (max-width: 1024px) {

            .lblProduct,
            .lblUser,
            .lblSubscriber {
                width: 45vw;
            }

            .btnEditProduct,
            .btnDeleteProduct,
            .btnBuyProduct,
            .btnEditUser,
            .btnDeleteUser {
                width: 50%;
            }

            #btnCreateProduct,
            #btnCreateUser {
                width: 30%;
            }

            input,
            .btnForm,
            .lblFormExtention,
            .lblFileUpload,
            #mapinForm,
            select#txtUpdateUserRole {
                width: 50%;
            }

            #mapinForm {
                height: 300px;
            }

            #lblDropdown:hover #lblDropdownContent:hover {
                height: 15em;
            }

            input#txtSearchProducts {
                width: 30%;
                margin-right: 5%;
            }

            #lblWelcomeUserMessage {
                margin-left: 5%;
            }

            .btnHorizontal {
                width: 15%;
            }
        }
    </style>
</head>

<!-- ********************************************************************** -->
<!--                                ALL THE HTML!                           -->
<!-- ********************************************************************** -->

<body>

    <!-- NAVIGATION according ADMIN or USER -->
    <header>
        <button id="btnViewProducts" class="btnShowPage" data-showThisPage="pageViewProducts">
            <img src="images/Fashion-Logo-6.png" alt="logo" id="logo">
        </button>
        <div id="lblWelcomeUserMessage"></div>
        <input type="text" name="txtSearchProducts" id="txtSearchProducts" placeholder="Search">
        <button type="button" class="btnShowPage btnHorizontal btnHeader" id="btnLoginNav" data-showThisPage="pageLogin">Login</button>
        <button type="button" class="btnShowPage btnHorizontal btnHeader" id="btnSignupNav" data-showThispage="pageSignup">Signup</button>
        <div id="lblDropdownforMobileOnly">
            <button class="btnHeader btnDropdown">
                <i class="fa fa-caret-down"></i>
            </button>
            <div id="lblDropdownContentforMobileOnly">
                <button type="button" class="btnShowPage btnHeader btnDropdown" id="btnLoginNavMobile" data-showThisPage="pageLogin">Login</button>
                <button type="button" class="btnShowPage btnHeader btnDropdown" id="btnSignupNavMobile" data-showThispage="pageSignup">Signup</button>
            </div>
        </div>
        <div id="lblDropdown">
            <button class="btnHeader btnDropdown">
                <i class="fa fa-caret-down"></i>
            </button>
            <div id="lblDropdownContent">
                <button id="btnEditUsersNav" class="btnShowPage btnHeader btnDropdown" data-showThisPage="pageViewUsers">Edit Users</button>
                <button id="btnEditProductsNav" class="btnShowPage btnHeader btnDropdown" data-showThisPage="pageViewProducts">Edit Products</button>
                <button id="btnViewSubscribersNav" class="btnShowPage btnHeader btnDropdown" data-showThisPage="pageViewSubscribers">View Subscribers</button>
                <button id="btnEditAccountNav" class="btnShowPage btnHeader btnDropdown" data-showThisPage="pageEditAccount">Edit Account</button>
                <button id="btnDeleteAccountNav" class="btnShowPage btnHeader btnDropdown" data-showThisPage="pageDeleteAccount">Delete Account</button>
                <button class="btnHeader btnDropdown" id="btnLogoutNav">Logout</button>
            </div>
        </div>
    </header>

    <!-- ********************************************************************** -->
    <!-- ********************************************************************** -->
    <!-- ********************************************************************** -->

    <!-- PRODUCTS display and editing is handled here according USER or ADMIN-->
    <div id="pageViewProducts" class="page">
        <div class="wrapper">
            <button type="button" class="btnShowPage" id="btnCreateProduct" data-showThisPage="pageCreateProduct">
                <i class="fa fa-plus"></i>&nbsp;Add Product</button>
            <form id="frmSortBy">
                <p>Sort by:</p>
                <select id="slctProductSorter">
                    <option value="oPriceLowToHigh" selected>PRICE</option>
                    <option value="oPriceLowToHigh">PRICE (LOW TO HIGH)</option>
                    <option value="oPriceHighToLow">PRICE (HIGH TO LOW)</option>
                </select>
            </form>
            <div id="lblProductList">
                <!-- Generated dynamically -->
            </div>
        </div>
    </div>

    <!-- ********************************************************************** -->
    <!-- ********************************************************************** -->
    <!-- ********************************************************************** -->

    <!-- USERS display and editing is handled here ONLY for ADMIN -->
    <div id="pageViewUsers" class="page">
        <div class="wrapper">
            <button type="button" class="btnShowPage" id="btnCreateUser" data-showThisPage="pageCreateUser">
                <i class="fa fa-plus"></i>&nbsp;Add User</button>
            <div id="lblUserList">

                <!-- Generated dynamically -->
            </div>
        </div>
    </div>

    <!-- ********************************************************************** -->
    <!-- ********************************************************************** -->
    <!-- ********************************************************************** -->

    <!-- SUBSCRIBERS display is handled here ONLY for ADMIN -->
    <div id="pageViewSubscribers" class="page popup">
        <div class="wrapper">
            <div id="lblSubscriberList">
                <!-- Generated dynamically -->
            </div>
            <div id="map">
                <!-- Generated dynamically -->
            </div>


        </div>
    </div>

    <!-- ********************************************************************** -->
    <!-- ********************************************************************** -->
    <!-- ********************************************************************** -->

    <!-- SIGNUP for USERS and ADMIN -->
    <div id="pageSignup" class="page popup">
        <div class="wrapper">
            <h3>SIGNUP</h3>
            <form class="form" id="frmSignup">
                <input type="text" name="txtEmailorPhoneNumber" placeholder="Mobile number or Email" required>
                <input type="text" name="txtFirstName" placeholder="Name" required>
                <input type="text" name="txtLastName" placeholder="Lastname" required>
                <input type="password" name="txtPassword" placeholder="Password" required>
                <div class="lblFileUpload">
                    <p>Select your picture:</p>
                    <input type="file" name="fileUserImage" required>
                </div>
                <button type="button" class="btnForm" id="btnSignupForm">Signup</button>
                <div class="lblFormExtention">
                    <p class="pyesAccount">Already have an account?</p>
                    <button type="button" class="btnShowPage" id="btnLogin" data-showThisPage="pageLogin">Login</button>
                </div>
            </form>
            <h3 class="lblErrorMessage" id="lblSignupErrorMessage"></h3>
        </div>
    </div>

    <!-- ********************************************************************** -->
    <!-- ********************************************************************** -->
    <!-- ********************************************************************** -->

    <!-- LOGIN for USERS and ADMIN -->
    <div id="pageLogin" class="page popup">
        <div class="wrapper">
            <h3>LOGIN</h3>
            <form class="form" id="frmLogin">
                <input type="text" name="txtEmailorPhoneNumber" placeholder="Mobile number or Email" required>
                <input type="text" name="txtPassword" placeholder="Password" required>
                <button type="button" class="btnForm" id="btnLoginForm">Login</button>
                <div class="lblFormExtention">
                    <p class="pnoAccount">Don´t have an account?</p>
                    <button type="button" class="btnShowPage" id="btnSignup">Signup</button>
                </div>
            </form>
            <h3 class="lblErrorMessage" id="lblLoginErrorMessage"></h3>
        </div>
    </div>

    <!-- ********************************************************************** -->
    <!-- ********************************************************************** -->
    <!-- ********************************************************************** -->

    <!-- SUBSCRIBE for USERS -->
    <div id="pageSubscribe" class="page popup">
        <div class="wrapper">
            <h3>SUBSCRIBE TO OUR NEWSLETTER</h3>
            <form class="form" id="frmSubscribe">
                <input type="text" name="txtEmail" placeholder="Email" required>
                <input type="text" name="txtFirstName" placeholder="FirstName" required>
                <input type="text" name="txtLastName" placeholder="Lastname" required>
                <div id="mapinForm">
                    <!-- Generated dynamically -->
                </div>
                <button type="button" class="btnForm" id="btnSubscribeForm">Subscribe</button>
            </form>
            <h3 class="lblErrorMessage" id="lblSubscribeErrorMessage"></h3>
        </div>
    </div>


    <!-- ********************************************************************** -->
    <!-- ********************************************************************** -->
    <!-- ********************************************************************** -->

    <!-- EDIT own account for USERS and ADMIN -->
    <div id="pageEditAccount" class="page popup">
        <div class="wrapper">
            <h3>EDIT ACCOUNT</h3>
            <form class="form" id="frmEditAccount">
                <input type="hidden" name="txtUserId" id="txtEditAccountId">
                <input type="text" id="txtEditAccountEmailorPhoneNumber" name="txtEmailorPhoneNumber" placeholder="Mobile number or Email">
                <input type="text" id="txtEditAccountName" name="txtFirstName" placeholder="Name">
                <input type="text" id="txtEditAccountLastName" name="txtLastName" placeholder="Lastname">
                <input type="password" id="txtEditAccountPassword" name="txtPassword" placeholder="Password">
                <img id="txtEditAccountImage" alt="AccountImage">
                <div class="lblFileUpload">
                    <p>Select your picture:</p>
                    <input type="file" name="fileUserImage">
                </div>
                <button type="button" class="btnForm" id="btnEditAccountForm">Update</button>
            </form>
            <h3 class="lblErrorMessage" id="lblEditAccountErrorMessage"></h3>
        </div>
    </div>

    <!-- ********************************************************************** -->
    <!-- ********************************************************************** -->
    <!-- ********************************************************************** -->

    <!-- DELETE own account for USERS and ADMIN -->
    <div id="pageDeleteAccount" class="page popup">
        <div class="wrapper">
            <h3>DELETE ACCOUNT</h3>
            <form class="form" id="frmDeleteAccount">
                <input type="text" id="txtDeleteAccountEmailorPhoneNumber" name="txtEmailorPhoneNumber" placeholder="Mobile number or Email">
                <input type="password" name="txtPassword" placeholder="Password">
                <button type="button" class="btnForm" id="btnDeleteAccountForm">Delete</button>
            </form>
            <h3 class="lblErrorMessage" id="lblDeleteAccountErrorMessage"></h3>
        </div>
    </div>

    <!-- ********************************************************************** -->
    <!-- ********************************************************************** -->
    <!-- ********************************************************************** -->

    <!-- CREATE product for ADMIN -->
    <div id="pageCreateProduct" class="page popup">
        <div class="wrapper">
            <h3>ADD PRODUCT</h3>
            <form class="form" id="frmCreateProduct">
                <input type="text" name="txtProductName" placeholder="Product Name" required>
                <input type="number" name="nrProductPrice" placeholder="Product Price" required>
                <input type="number" name="nrProductQuantity" placeholder="Product Quantity" required>
                <div class="lblFileUpload">
                    <p>Select your product:</p>
                    <input type="file" name="fileProductImage" required>
                </div>
                <button type="button" class="btnShowPage btnForm" id="btnCreateProductForm">Add Product</button>
            </form>
            <h3 class="lblErrorMessage" id="lblCreateProductErrorMessage"></h3>
        </div>
    </div>

    <!-- CREATE user for ADMIN -->
    <div id="pageCreateUser" class="page popup">
        <div class="wrapper">
            <h3>ADD USER</h3>
            <form class="form" id="frmCreateUser">
                <select name="txtUserRole" id="txtCreateUserRole">
                    <option value="1">User</option>
                    <option value="2">Admin</option>
                </select>
                <input type="text" id="txtEmailorPhoneNumber" name="txtEmailorPhoneNumber" placeholder="Mobile number or Email">
                <input type="text" name="txtFirstName" placeholder="Name" required>
                <input type="text" name="txtLastName" placeholder="Lastname" required>
                <input type="password" name="txtPassword" placeholder="Password" required>
                <div class="lblFileUpload">
                    <p>Select user picture:</p>
                    <input type="file" name="fileUserImage" required>
                </div>
                <button type="button" class="btnShowPage btnForm" id="btnCreateUserForm">Add User</button>
            </form>
            <h3 class="lblErrorMessage" id="lblCreateUserErrorMessage"></h3>
        </div>
    </div>

    <!-- ********************************************************************** -->
    <!-- ********************************************************************** -->
    <!-- ********************************************************************** -->

    <!-- UPDATE product for ADMIN -->
    <div id="pageUpdateProduct" class="page popup">
        <div class="wrapper">
            <h3>UPDATE PRODUCT</h3>
            <form class="form" id="frmUpdateProduct">
                <input type="hidden" id="txtUpdateProductCode" name="txtProductCode">
                <input type="text" id="txtUpdateProductName" name="txtProductName" placeholder="Product Name">
                <input type="number" id="nrUpdateProductPrice" name="nrProductPrice" placeholder="Product Price">
                <input type="number" id="nrUpdateProductQuantity" name="nrProductQuantity" placeholder="Product Quantity">
                <img id="txtUpdateProductImage" alt="ProductImage">
                <div class="lblFileUpload">
                    <p>Select your product:</p>
                    <input type="file" name="fileProductImage">
                </div>
                <button type="button" class="btnShowPage btnForm" id="btnUpdateProductForm">Update Product</button>
            </form>
            <h3 class="lblErrorMessage" id="lblUpdateProductErrorMessage"></h3>
        </div>
    </div>

    <!-- ********************************************************************** -->
    <!-- ********************************************************************** -->
    <!-- ********************************************************************** -->

    <!-- UPDATE user for ADMIN -->
    <div id="pageUpdateUser" class="page popup">
        <div class="wrapper">
            <h3>UPDATE USER</h3>
            <form class="form" id="frmUpdateUser">
                <input type="hidden" id="txtUpdateUserId" name="txtUserId">
                <select name="txtUserRole" id="txtUpdateUserRole">
                    <option value="1">User</option>
                    <option value="2">Admin</option>
                </select>
                <input type="text" id="txtUpdateUserEmailorPhoneNumber" name="txtEmailorPhoneNumber" placeholder="Mobile number or Email">
                <input type="text" id="txtUpdateUserName" name="txtFirstName" placeholder="Name">
                <input type="text" id="txtUpdateUserLastName" name="txtLastName" placeholder="Lastname">
                <input type="password" id="txtUpdateUserPassword" name="txtPassword" placeholder="Password">
                <img id="txtUpdateUserImage" alt="UserImage">
                <div class="lblFileUpload">
                    <p>Select your picture:</p>
                    <input type="file" name="fileUserImage">
                </div>
                <button type="button" class="btnForm" id="btnUpdateUserForm">Update User</button>
            </form>
            <h3 class="lblErrorMessage" id="lblUpdateUserErrorMessage"></h3>
        </div>
    </div>

    <!-- ********************************************************************** -->
    <!-- ********************************************************************** -->
    <!-- ********************************************************************** -->

    <!-- FOOTER -->
    <footer>

        <button type="button" class="btnShowPage btnFooter" id="btnSubscribeNav" data-showThispage="pageSubscribe">Subscribe to newsletter</button>

    </footer>

    <!-- ********************************************************************** -->
    <!--                                END HTML                                -->
    <!-- ********************************************************************** -->

    <script>
        /************************************************************************/
        /************************************************************************/
        //                      All the JAVASCRIPT!
        /************************************************************************/
        /************************************************************************/

        // Define GLOBAL VARIABLES for the SESSIONSTORAGE 
        var loggedin = false;
        var role = "";
        var sUserId = "";

        /************************************************************************/
        /************************************************************************/
        /************************************************************************/

        // CHECK if there is a SESSION  
        if (sessionStorage.getItem('status') !== null) {
            // console.log( "loggedin" );
            loggedin = true;
        }

        /************************************************************************/
        /************************************************************************/
        /************************************************************************/

        // INITIALIZE / populate home page with products
        getProductData();

        /************************************************************************/
        /************************************************************************/
        /************************************************************************/

        // DO the SIGNUP, POST data to the SERVER with AJAX

        // GLOBAL ARRAY for the storing any USER DATA from the SERVER
        var ajUserDataFromServer = [];

        btnSignupForm.addEventListener("click", signupUser);

        function signupUser() {

            var request = new XMLHttpRequest();

            request.onreadystatechange = function () {
                if (this.readyState == 4 && this.status == 200) {

                    var ajUserDataFromServer = JSON.parse(this.responseText);
                    console.log("Response:", ajUserDataFromServer);

                    if (ajUserDataFromServer.status == "ok") {

                        //console.log( "SIGNUP SUCCESFULL" );
                        pageSignup.style.display = "none";
                        pageLogin.style.display = "flex";
                        lblLoginErrorMessage.innerHTML = "";
                        var sSignupSeuccesMessage = "Account succesfully created - Signup please";
                        var sSignupSeuccesMessage = sSignupSeuccesMessage.fontcolor("#549839");
                        lblLoginErrorMessage.insertAdjacentHTML('beforeend', sSignupSeuccesMessage);

                    } else {

                        //console.log( "SIGNUP FAIL - TRY AGAIN" );
                        pageViewProducts.style.display = "none";
                        pageSignup.style.display = "flex";
                        lblSignupErrorMessage.innerHTML = "";
                        var sSignupErrorMessage = "Signup Failed - Try again";
                        lblSignupErrorMessage.insertAdjacentHTML('beforeend', sSignupErrorMessage);

                    }
                }
            }

            request.open("POST", "apis/api_signup_user.php", true);
            var jFrmSignup = new FormData(frmSignup);
            request.send(jFrmSignup);

        }


        /************************************************************************/
        /************************************************************************/
        /************************************************************************/


        // DO the LOGIN, POST data to the SERVER with AJAX
        sessionUser();

        function sessionUser() {


            // for ADMIN view 
            if (sessionStorage.getItem('userRole') == "admin") {


                showWelcomeMessage();
                showAdminInterface();
                getProductData();
                getUserData();
                getSubriberData();
            }

            // for USER view 
            if (sessionStorage.getItem('userRole') == "user") {

                showWelcomeMessage();
                showUserInterface();
                getProductData();
            }

        }

        // Logs in the user and displays different HTML bits according diffrent roles by using sessionstorage
        btnLoginForm.addEventListener("click", loginUser);

        function loginUser() {
            // it is not the OPTIMAL way to fix the reload issue and there        
            var ajax = new XMLHttpRequest();
            ajax.onreadystatechange = function () {
                if (this.readyState == 4 && this.status == 200) {

                    ajUserDataFromServer = JSON.parse(this.responseText);
                    //console.log( "Response:", ajUserDataFromServer );

                    if (ajUserDataFromServer.status == "ok") {

                        //after login also sets key values to the sessionstorage
                        sessionStorage.setItem('status', 'loggedin');
                        sessionStorage.setItem('userId', ajUserDataFromServer.userId);
                        sessionStorage.setItem('userRole', ajUserDataFromServer.userRole);
                        sessionStorage.setItem('userName', ajUserDataFromServer.userName);
                        sessionStorage.setItem('firstName', ajUserDataFromServer.firstName);
                        sessionStorage.setItem('lastName', ajUserDataFromServer.lastName);
                        sessionStorage.setItem('image', ajUserDataFromServer.image);

                        pageLogin.style.display = "none";

                        loggedin = true;


                        // for ADMIN view 
                        if ((loggedin === true) && (sessionStorage.getItem('userRole') === "admin")) {


                            showWelcomeMessage();
                            showAdminInterface();
                            getProductData();
                            getUserData();
                            getSubriberData();


                            // for USER view 
                        } else if (loggedin === true && sessionStorage.getItem('userRole') === "user") {

                            showWelcomeMessage();
                            showUserInterface();
                            getProductData();

                        }

                    } else {

                        //console.log( "LOGIN FAIL - TRY AGAIN" );
                        pageLogin.style.display = "flex";
                        pageViewProducts.style.display = "none";
                        lblLoginErrorMessage.innerHTML = "";
                        var sLoginErrorMessage = "Login Failed - Try again";
                        lblLoginErrorMessage.insertAdjacentHTML('beforeend', sLoginErrorMessage);

                    }
                }
            }


            ajax.open("POST", "apis/api_login_user.php", true);
            var jFrmLogin = new FormData(frmLogin);
            ajax.send(jFrmLogin);

        }

        /************************************************************************/
        /************************************************************************/
        /************************************************************************/


        // Assign id as value to hiddden empty field after LOGIN for sending to the SERVER later when EDITING own ACCOUNT for ALL 
        /*function setInputValue() {
         sUserId = sessionStorage.getItem( 'id' );   //ajUserDataFromServer.id;
         document.getElementById( "txtEditAccountId" ).value = sUserId;
        }*/

        /************************************************************************/
        /************************************************************************/
        /************************************************************************/


        // GET all users from from the server in order to display / CRUD for the admin 
        function getUserData() {
            var request = new XMLHttpRequest();
            request.onreadystatechange = function () {
                if (this.readyState == 4 && this.status == 200) {

                    ajUserDataFromServer = JSON.parse(this.responseText);
                    //console.log( "Response:", ajUserDataFromServer );

                    if (sessionStorage.getItem('userRole') === "admin") {
                        //console.log( "USERS ARE EDITABLE" );
                        showUsers();
                    }
                }
            }

            request.open("GET", "apis/api_get_users.php", true);
            request.send();

        }

        /************************************************************************/
        /************************************************************************/
        /************************************************************************/


        // DISPLAY ALL users dinamically using a loop and then INSERT into HTML
        function showUsers() {

            lblUserList.innerHTML = "";

            for (var i = 0; i < ajUserDataFromServer.length; i++) {

                var lblUser = document.createElement('div');
                lblUser.classList.add("lblUser");

                lblUser.innerHTML = '<img src="' + ajUserDataFromServer[i].image +
                    '" alt="user" class="lblUserImage" data-userImage="' + ajUserDataFromServer[i].image + '">' +
                    '<h3 class="lblUserId" data-userId"' + ajUserDataFromServer[i].userId + '">' + 'Id:' + ' ' +
                    ajUserDataFromServer[i].userId + '</h3>' + '<h3 class="lblUserRole" data-userRole="' +
                    ajUserDataFromServer[i].userRole + '">' + 'Role:' + ' ' + ajUserDataFromServer[i].userRole +
                    '</h3>' + '<h3 class="lblUserEmailorPhoneNumber" data-userEmailorPhoneNumber="' +
                    ajUserDataFromServer[i].userName + '">' + 'Username:' + ' ' + ajUserDataFromServer[i].userName +
                    '</h3>' + '<h3 class="lblUserName" data-userName="' + ajUserDataFromServer[i].firstName + '">' +
                    'Name:' + ' ' + ajUserDataFromServer[i].firstName + '</h3>' +
                    '<h3 class ="lblUserLastName" data-userLastName="' + ajUserDataFromServer[i].lastName + '">' +
                    'Lastname:' + ' ' + ajUserDataFromServer[i].lastName + '</h3>' +
                    '<h3 class="lblUserPassword" data-userPassword="' + ajUserDataFromServer[i].password + '">' +
                    'Password:' + ' ' + ajUserDataFromServer[i].password + '</h3>' +
                    '<button id="btnEditUserBody" class="btnShowPage btnEditUser" data-userId="' + ajUserDataFromServer[
                        i].userId + '" data-showThisPage="pageUpdateUser">' + 'EDIT USER' + '</button>' +
                    '<button class="btnDeleteUser" data-userId="' + ajUserDataFromServer[i].userId + '" >' +
                    'DELETE USER' + '</button>' + '<h3 class="lblErrorMessage" id="lblDeleteUserErrorMessage">' +
                    '</h3>';


                /*if ( ajUserDataFromServer[i].email ) { //if email has a value ADD email to the DIV
                      
                  var lblUserEmail = document.createElement('h3');     
                  lblUserEmail.classList.add( "lblUserEmailorPhoneNumber" );
                  lblUserEmail.setAttribute( "data-userEmailorPhoneNumber", ajUserDataFromServer[i].email );
                  lblUserEmail.innerText =  'Email:' + ' ' + ajUserDataFromServer[i].email;
                 
                  lblUser.insertBefore( lblUserEmail, lblUser.children[3] );
                  //parentElement.insertBefore(newElement, parentElement.children[2]);
                    
                  }
          
                if ( ajUserDataFromServer[i].phonenumber ) { //if pnonenumber has a value ADD phonenumber to the DIV
                      
                  var lblUserPhoneNumber = document.createElement('h3');
                  lblUserPhoneNumber.classList.add( "lblUserEmailorPhoneNumber" );
                  lblUserPhoneNumber.setAttribute( "data-userEmailorPhoneNumber", ajUserDataFromServer[i].phonenumber );
                  lblUserPhoneNumber.innerText =  'Phone-number:' + ' ' + ajUserDataFromServer[i].phonenumber;
                 
                  lblUser.insertBefore( lblUserPhoneNumber, lblUser.children[3] );
                       
                  }*/

                lblUserList.appendChild(lblUser);

                showPages();
            }
        }



        /************************************************************************/
        /************************************************************************/
        /************************************************************************/


        // HTML / user interface for ADMIN view
        function showAdminInterface() {

            lblDropdown.style.display = "flex";
            lblDropdownforMobileOnly.style.display = "none";
            btnCreateProduct.style.display = "flex";
            btnCreateUser.style.display = "flex";
            pageViewProducts.style.display = "flex";
            btnSignupNav.style.display = "none";
            btnLoginNav.style.display = "none";
            btnSubscribeNav.style.display = "none";

        }


        /************************************************************************/
        /************************************************************************/
        /************************************************************************/


        // HTML / user interface for USER view
        function showUserInterface() {

            lblDropdown.style.display = "flex";
            lblDropdownforMobileOnly.style.display = "none";
            pageViewProducts.style.display = "flex";
            btnEditUsersNav.style.display = "none";
            btnEditProductsNav.style.display = "none";
            btnViewSubscribersNav.style.display = "none";
            btnCreateProduct.style.display = "none";
            btnCreateUser.style.display = "none";
            btnSignupNav.style.display = "none";
            btnLoginNav.style.display = "none";

        }

        /************************************************************************/
        /************************************************************************/
        /************************************************************************/

        // Dynamic HTML / user interface for ALL users
        function showWelcomeMessage() {

            lblWelcomeUserMessage.innerHTML = "";

            //console.log( "WELCOME:" + ajUserDataFromServer.role ) ;
            var sWelcomeUserMessage = '<h3>' + 'Welcome:' + '  ' + sessionStorage.getItem('firstName') + '  ' +
                sessionStorage.getItem('lastName') + '  ' + sessionStorage.getItem('userRole') + ' </h3>';
            var iUserImage = '<img src=" ' + sessionStorage.getItem('image') + ' " width="50px">';
            lblWelcomeUserMessage.insertAdjacentHTML('beforeend', sWelcomeUserMessage);
            lblWelcomeUserMessage.insertAdjacentHTML('beforeend', iUserImage);
        }

        /************************************************************************/
        /************************************************************************/
        /************************************************************************/


        // Updates own account for ALL with POST
        btnEditAccountForm.addEventListener("click", editOwnAccount);

        function editOwnAccount() {

            //console.log(txtEditAccountId.value); 

            var ajax = new XMLHttpRequest();
            ajax.onreadystatechange = function () {
                if (this.readyState == 4 && this.status == 200) {

                    var ajUserDataFromServer = JSON.parse(this.responseText);
                    //console.log( "Response:", ajUserDataFromServer);

                    if (ajUserDataFromServer.status == "ok") {

                        //console.log( "ACCOUNT UPDATED" );
                        pageViewProducts.style.display = "flex";
                        pageEditAccount.style.display = "none";
                        //getUserData(); //LOAD Users once again 
                        sessionStorage.setItem('userName', ajUserDataFromServer.userName);
                        sessionStorage.setItem('firstName', ajUserDataFromServer.firstName);
                        sessionStorage.setItem('lastName', ajUserDataFromServer.lastName);
                        sessionStorage.setItem('image', ajUserDataFromServer.image);
                        showWelcomeMessage();

                    } else {

                        //console.log( "UPDATE FAIL" );
                        pageEditAccount.style.display = "flex";
                        pageViewProducts.style.display = "none";
                        lblEditAccountErrorMessage.innerHTML = "";
                        var sEditAccountErrorMessage = "Updating Account Failed - Try again";
                        lblEditAccountErrorMessage.insertAdjacentHTML('beforeend', sEditAccountErrorMessage);

                    }

                }
            }

            ajax.open("POST", "apis/api_edit_account.php", true);
            var jFrmEditAccount = new FormData(frmEditAccount);
            ajax.send(jFrmEditAccount);

        }

        /************************************************************************/
        /************************************************************************/
        /************************************************************************/


        // Delete own ACCOUNT for ALL with POST
        btnDeleteAccountForm.addEventListener("click", deleteAccount);

        function deleteAccount() {

            var ajax = new XMLHttpRequest();
            ajax.onreadystatechange = function () {
                if (this.readyState == 4 && this.status == 200) {

                    var ajUserDataFromServer = JSON.parse(this.responseText);
                    //console.log( "Response:", ajUserDataFromServer );

                    if (ajUserDataFromServer.status == "ok") {

                        //console.log( "ACCOUNT DELETED" );

                        logoutUser();

                    } else {

                        //console.log( "DELETE FAIL" );
                        pageDeleteAccount.style.display = "flex";
                        lblDeleteAccountErrorMessage.innerHTML = "";
                        var sDeleteAccountErrorMessage = "Deleting Account Failed - Try again";
                        lblDeleteAccountErrorMessage.insertAdjacentHTML('beforeend', sDeleteAccountErrorMessage);

                    }

                }
            }

            ajax.open("POST", "apis/api_delete_account.php", true);
            var jFrmDeleteAccount = new FormData(frmDeleteAccount);
            ajax.send(jFrmDeleteAccount);

        }

        /************************************************************************/
        /************************************************************************/
        /************************************************************************/


        btnCreateUserForm.addEventListener("click", createUser);

        function createUser() {

            var request = new XMLHttpRequest();

            request.onreadystatechange = function () {
                if (this.readyState == 4 && this.status == 200) {

                    var ajUserDataFromServer = JSON.parse(this.responseText);
                    //console.log( "Response:", ajUserDataFromServer );

                    if (ajUserDataFromServer.status == "ok") {

                        //console.log( "CREATING USER SUCCESFULL" );
                        pageCreateUser.style.display = "none";
                        pageViewUsers.style.display = "flex";
                        getUserData();

                    } else {

                        //console.log( "CREATING USER FAILED - TRY AGAIN" );
                        pageViewProducts.style.display = "none";
                        pageCreateUser.style.display = "flex";
                        lblCreateUserErrorMessage.innerHTML = "";
                        var sCreateUserErrorMessage = "Creating User Failed - Try again";
                        lblCreateUserErrorMessage.insertAdjacentHTML('beforeend', sCreateUserErrorMessage);

                    }
                }
            }

            request.open("POST", "apis/api_create_user.php", true);
            var jFrmCreateUser = new FormData(frmCreateUser);
            request.send(jFrmCreateUser);

        }



        /************************************************************************/
        /************************************************************************/
        /************************************************************************/


        // Delete users for ADMIN with GET 
        document.addEventListener("click", function (e) {

            if (e.target.classList.contains("btnDeleteUser")) {
                /// get users based on id
                sUserId = e.target.getAttribute("data-userId");
                //console.log(sUserId);
                var sUrl = "apis/api_delete_user.php?id=" + sUserId;

                var request = new XMLHttpRequest();
                request.onreadystatechange = function () {
                    if (this.readyState == 4 && this.status == 200) {

                        ajUserDataFromServer = JSON.parse(this.responseText);
                        console.log("Response:", ajUserDataFromServer);

                        if (ajUserDataFromServer.status == "ok") {

                            //console.log( "USER DELETED FROM THE DATABASE" );
                            e.target.parentNode.parentNode.removeChild(e.target.parentNode);

                        } else {

                            //console.log("USER NOT DELETED FROM THE DATABASE");
                            lblDeleteUserErrorMessage.innerHTML = "";
                            var sDeleteUserErrorMessage = "Deleting User Failed - Try again";
                            lblDeleteUserErrorMessage.insertAdjacentHTML('beforeend',
                                sDeleteUserErrorMessage);

                        }
                    }
                }

                request.open("GET", sUrl, true);
                request.send();

            }

        });

        /************************************************************************/
        /************************************************************************/
        /************************************************************************/


        // LOG OUT ALL and CLEAR sessionstorage

        btnLogoutNav.addEventListener("click", logoutUser);

        function logoutUser() {

            var ajax = new XMLHttpRequest();
            ajax.onreadystatechange = function ()

            {
                sessionStorage.clear();
                location.reload();

            }

            ajax.open("GET", "apis/api_logout.php", true);
            ajax.send();
        }

        /************************************************************************/
        /************************************************************************/
        /************************************************************************/


        // GLOBAL ARRAY for the storing any PRODUCT DATA from the SERVER
        var ajProductDataFromServer = [];

        btnCreateProductForm.addEventListener("click", createProduct);

        //creating products
        function createProduct() {

            var request = new XMLHttpRequest();

            request.onreadystatechange = function () {
                if (this.readyState == 4 && this.status == 200) {

                    var ajProductDataFromServer = this.responseText;
                    //console.log( "Response:" + ajProductDataFromServer );

                    if (ajProductDataFromServer.status == "ok") {

                        //console.log( "ADD PRODUCT SUCCESFULL" )
                        showAdminInterface();
                        getProductData();

                    } else {

                        //console.log( "ADD PRODUCT FAIL - TRY AGAIN" );
                        pageCreateProduct.style.display = "flex";
                        lblCreateProductErrorMessage.innerHTML = "";
                        var sCreateProductErrorMessage = "Adding Product Failed - Try again";
                        lblCreateProductErrorMessage.insertAdjacentHTML('beforeend', sCreateProductErrorMessage);
                    }
                }
            }

            request.open("POST", "apis/api_create_product.php", true);
            var jFrmCreateProduct = new FormData(frmCreateProduct);
            request.send(jFrmCreateProduct);

        }

        /************************************************************************/
        /************************************************************************/
        /************************************************************************/


        // GET ALL PRODUCTS and display them with diffrent features according role
        function getProductData() {

            var request = new XMLHttpRequest();
            request.onreadystatechange = function () {
                if (this.readyState == 4 && this.status == 200) {

                    ajProductDataFromServer = JSON.parse(this.responseText);
                    //console.log( "Response:", ajProductDataFromServer );

                    if (sessionStorage.getItem('userRole') === "admin") {
                        //console.log( "PRODUCTS ARE EDITABLE" );
                        showProductAdmin();

                    } else if (sessionStorage.getItem('userRole') === "user") {
                        //console.log( "PRODUCTS ARE AVAILABLE FOR USER" );
                        showProduct();

                    } else {
                        //console.log( "PRODUCTS AVAILABLE FOR PUBLIC" );
                        showProduct();
                    }

                }
            }

            request.open("GET", "apis/api_get_products.php", true);
            request.send();

        }

        /************************************************************************/
        /************************************************************************/
        /************************************************************************/

        txtSearchProducts.addEventListener("keyup", function () {
            var sSearch = document.getElementById("txtSearchProducts").value;
            //console.log( sSearch );        
            var sUrl = "apis/api_search_products.php?search=" + sSearch;

            var request = new XMLHttpRequest();
            request.onreadystatechange = function () {
                if (this.readyState == 4 && this.status == 200) {
                    ajProductDataFromServer = JSON.parse(this.responseText);
                    console.log("Response:", ajProductDataFromServer);



                    if (sessionStorage.getItem('userRole') === "admin") {

                        showProductAdmin();
                        //console.log ("SEARCH FOUND");

                    } else {

                        showProduct();
                        //console.log ("SEARCH FOUND");

                    }


                }
            }

            request.open("GET", sUrl, true);
            request.send();

        });

        /************************************************************************/
        /************************************************************************/
        /************************************************************************/

        // GET ALL PRODUCTS and sort them by price HIGH to LOW 
        slctProductSorter.addEventListener("change", function () {

            var request = new XMLHttpRequest();
            request.onreadystatechange = function () {

                if (this.readyState == 4 && this.status == 200) {

                    ajProductDataFromServer = JSON.parse(this.responseText);
                    //console.log( "Response:" + ajProductDataFromServer ); 

                    if (slctProductSorter.value == "oPriceHighToLow") {

                        if (sessionStorage.getItem('userRole') === "admin") {

                            showProductAdmin();
                        } else {

                            showProduct();
                        }
                    } else if (slctProductSorter.value == "oPriceLowToHigh") {

                        showPricelowToHigh();

                    }

                }
            }

            request.open("GET", "apis/api_sort_price_highTolow.php", true);
            request.send();

        });


        // GET ALL PRODUCTS and sort them by price LOW to HIGH
        function showPricelowToHigh() {

            var request = new XMLHttpRequest();
            request.onreadystatechange = function () {

                if (this.readyState == 4 && this.status == 200) {

                    ajProductDataFromServer = JSON.parse(this.responseText);
                    //console.log( "Response:" + ajProductDataFromServer ); 

                    if (sessionStorage.getItem('userRole') === "admin") {

                        showProductAdmin();
                    } else {

                        showProduct();
                    }
                }
            }

            request.open("GET", "apis/api_sort_price_lowTohigh.php", true);
            request.send();

        }

        /************************************************************************/
        /************************************************************************/
        /************************************************************************/


        // DISPLAY PRODUCTS for ADMIN dinamically using a loop and then INSERT into HTML
        function showProductAdmin() {

            lblProductList.innerHTML = "";

            for (var i = 0; i < ajProductDataFromServer.length; i++) {

                var lblProduct = '<div class="lblProduct">' + '<a href="#' + ajProductDataFromServer[i].image + '">' +
                    '<img src="' + ajProductDataFromServer[i].image +
                    '" width="85%" alt="product" class="lblProductImage" data-productImage="' + ajProductDataFromServer[
                        i].image + '">' + '</a>' + '<a href="#_" class="lightbox" id="' + ajProductDataFromServer[i].image +
                    '">' + '<img src="' + ajProductDataFromServer[i].image + '">' + '</a>' +
                    '<h3 class ="lblProductName" data-productName="' + ajProductDataFromServer[i].productName + '" >' +
                    ajProductDataFromServer[i].productName + '</h3>' +
                    '<h3 class ="lblProductPrice" data-productPrice="' + ajProductDataFromServer[i].buyPrice + '">' +
                    'Price:' + ' ' + ajProductDataFromServer[i].buyPrice + ' ' + 'DKK' + '</h3>' +
                    '<h3 class ="lblProductQuantity" data-productQuantity="' + ajProductDataFromServer[i].quantityInStock +
                    '">' + 'Quantity:' + ' ' + ajProductDataFromServer[i].quantityInStock + '</h3>' +
                    '<button id="btnEditProductBody" class="btnShowPage btnEditProduct" data-showThisPage="pageUpdateProduct" data-productCode="' +
                    ajProductDataFromServer[i].productCode + '">' + 'EDIT PRODUCT' + '</button>' +
                    '<button class="btnDeleteProduct" data-productCode="' + ajProductDataFromServer[i].productCode +
                    '" >' + 'DELETE PRODUCT' + '</button>' +
                    '<h3 class="lblErrorMessage" id="lblDeleteProductErrorMessage">' + '</h3>' + '</div>';

                lblProductList.insertAdjacentHTML('beforeend', lblProduct);
                showPages();

            }

        }

        /************************************************************************/
        /************************************************************************/
        /************************************************************************/


        // DISPLAY PRODUCTS for USER / PUBLIC dinamically using a loop and then INSERT into HTML
        function showProduct() {
            lblProductList.innerHTML = "";

            for (var i = 0; i < ajProductDataFromServer.length; i++) {

                var lblProduct = '<div class ="lblProduct">' + '<a href="#' + ajProductDataFromServer[i].image + '">' +
                    '<img src="' + ajProductDataFromServer[i].image +
                    '" width="85%" class="lblProductImage" alt="product">' + '</a>' +
                    '<a href="#_" class="lightbox" id="' + ajProductDataFromServer[i].image + '">' + '<img src="' +
                    ajProductDataFromServer[i].image + '">' + '</a>' + '<h3 class ="lblProductName">' +
                    ajProductDataFromServer[i].productName + '</h3>' + '<h3 class ="lblProductPrice">' + 'Price:' + ' ' +
                    ajProductDataFromServer[i].buyPrice + ' ' + 'DKK' + '</h3>' + '<h3 class ="lblProductQuantity">' +
                    'Quantity:' + ' ' + ajProductDataFromServer[i].quantityInStock + '</h3>' +
                    '<button class="btnBuyProduct" data-productCode="' + ajProductDataFromServer[i].productCode + '" >' +
                    'BUY PRODUCT' + '</button>' + '</div>';

                lblProductList.insertAdjacentHTML('beforeend', lblProduct);
            }

        }

        /************************************************************************/
        /************************************************************************/
        /************************************************************************/


        // hide and show pages on button clicks with data attribute
        function showPages() {

            var aBtnShowPages = document.getElementsByClassName("btnShowPage");
            // this is an array
            for (var i = 0; i < aBtnShowPages.length; i++) {

                aBtnShowPages[i].addEventListener("click", function () {
                    //console.log( "WORKS" ); 
                    // Hide the pages
                    var aPages = document.getElementsByClassName("page");
                    for (var j = 0; j < aPages.length; j++) {
                        aPages[j].style.display = "none";
                    }

                    var sDataAttribute = this.getAttribute("data-showThisPage");
                    //console.log( sDataAttribute );
                    document.getElementById(sDataAttribute).style.display = "flex";
                });

            }

        }

        showPages();

        /************************************************************************/
        /************************************************************************/
        /************************************************************************/


        // DELETE product for ADMIN based on productCode
        document.addEventListener("click", function (e) {

            if (e.target.classList.contains("btnDeleteProduct")) {

                sProductCode = e.target.getAttribute("data-productCode");
                //console.log( sProductCode );
                var sUrl = "apis/api_delete_product.php?code=" + sProductCode;

                var request = new XMLHttpRequest();
                request.onreadystatechange = function () {
                    if (this.readyState == 4 && this.status == 200) {

                        ajProductDataFromServer = JSON.parse(this.responseText);
                        //console.log( "Response:" + ajProductDataFromServer );

                        if (ajProductDataFromServer.status == "ok") {

                            //console.log( "PRODUCT DELETED FROM THE DATABASE" );
                            e.target.parentNode.parentNode.removeChild(e.target.parentNode);

                        } else {

                            //console.log( "PRODUCT NOT DELETED FROM THE DATABASE" );
                            lblDeleteProductErrorMessage.innerHTML = "";
                            var sDeleteProductErrorMessage = "Deleting Product Failed - Try again";
                            lblDeleteProductErrorMessage.insertAdjacentHTML('beforeend',
                                sDeleteProductErrorMessage);

                        }
                    }
                }

                request.open("GET", sUrl, true);
                request.send();

            }

        });

        /************************************************************************/
        /************************************************************************/
        /************************************************************************/


        // BUY product for user
        document.addEventListener("click", function (e) {

            if (e.target.classList.contains("btnBuyProduct")) {

                sProductCode = e.target.getAttribute("data-productCode");
                //console.log( sProductCode );
                var sUrl = "apis/api_buy_product.php?code=" + sProductCode;

                var request = new XMLHttpRequest();
                request.onreadystatechange = function () {
                    if (this.readyState == 4 && this.status == 200) {

                        ajProductDataFromServer = JSON.parse(this.responseText);
                        //console.log( "Response:", ajProductDataFromServer );

                        if (ajProductDataFromServer.status == "ok") {

                            if (!window.Notification) {

                                alert("Sorry, Notification Not supported in this Browser!");

                            } else {

                                if (Notification.permission === 'granted') {

                                    notify = new Notification('SHOPAHOLIC.com', {
                                        body: 'The product has been added to your shopping cart!"', // the name of the pruduct
                                        icon: 'images/Fashion-Logo-6.png' // I could show the respective product image
                                    });
                                }
                            }


                            playSound();

                            getProductData();

                            //console.log( ajProductDataFromServer.quantity );
                            //console.log( "PRODUCT QUANTITY DECREASED IN THE DATABASE" );

                        } else {

                            //console.log( "PRODUCT QUANTITY DID NOT DECREASE IN THE DATABASE" );
                            lblDeleteProductErrorMessage.innerHTML = "";
                            var sDeleteProductErrorMessage = "Deleting Product Failed - Try again";
                            lblDeleteProductErrorMessage.insertAdjacentHTML('beforeend',
                                sDeleteProductErrorMessage);

                        }
                    }
                }

                request.open("GET", sUrl, true);
                request.send();

            }

        });

        /************************************************************************/
        /************************************************************************/
        /************************************************************************/


        function playSound() {

            var oSound = new Audio('sounds/Coin-collect-sound-effect.mp3');
            oSound.play();

        }


        /************************************************************************/
        /************************************************************************/
        /************************************************************************/


        // Update product ADMIN
        document.addEventListener("click", function (e) {

            if (e.target.classList.contains("btnEditProduct")) {

                // does the following on the click of the dynamic edit button.
                // creates new variables which has the key values of the JSON OBJECTS products 
                sProductCode = e.target.getAttribute("data-productCode");
                //console.log(sProductCode);
                //console.log(e.target);
                sProductName = e.target.parentNode.querySelector("h3.lblProductName").getAttribute(
                    "data-productName");
                //console.log(sProductName);
                sProductPrice = e.target.parentNode.querySelector("h3.lblProductPrice").getAttribute(
                    "data-productPrice");
                //console.log(sProductPrice);
                sProductQuantity = e.target.parentNode.querySelector("h3.lblProductQuantity").getAttribute(
                    "data-productQuantity");
                //console.log(sProductQuantity);
                sProductImage = e.target.parentNode.querySelector("img.lblProductImage").getAttribute(
                    "data-productImage");

                // and sets that as a value for the textbox when you navigate to the page
                document.getElementById("txtUpdateProductCode").value = sProductCode;
                document.getElementById("txtUpdateProductName").value = sProductName;
                document.getElementById("nrUpdateProductPrice").value = sProductPrice;
                document.getElementById("nrUpdateProductQuantity").value = sProductQuantity;
                document.getElementById("txtUpdateProductImage").src = sProductImage;


            }
        });


        /************************************************************************/
        /************************************************************************/
        /************************************************************************/


        // Update user ADMIN
        document.addEventListener("click", function (e) {

            if (e.target.classList.contains("btnEditUser")) {

                // creates new variables which has the key values of the JSON OBJECTS products 
                sUserId = e.target.getAttribute("data-userId");
                //console.log( sUserId ); 
                sUserRole = e.target.parentNode.querySelector("h3.lblUserRole").getAttribute("data-userRole");
                //console.log( sUserRole );
                sUserEmailorPhoneNumber = e.target.parentNode.querySelector("h3.lblUserEmailorPhoneNumber").getAttribute(
                    "data-userEmailorPhoneNumber");
                //console.log( sUserEmailorPhoneNumber );
                sUserName = e.target.parentNode.querySelector("h3.lblUserName").getAttribute("data-userName");
                //console.log( sUserName );
                sUserLastName = e.target.parentNode.querySelector("h3.lblUserLastName").getAttribute(
                    "data-userLastName");
                //console.log( sUserLastName );
                sUserPassword = e.target.parentNode.querySelector("h3.lblUserPassword").getAttribute(
                    "data-userPassword");
                //console.log( sUserPassword );
                sUserImage = e.target.parentNode.querySelector("img.lblUserImage").getAttribute(
                    "data-userImage");

                // and puts that into the textbox when you navigate to the page.
                document.getElementById("txtUpdateUserId").value = sUserId;
                document.getElementById("txtUpdateUserRole").value = sUserRole;
                document.getElementById("txtUpdateUserEmailorPhoneNumber").value = sUserEmailorPhoneNumber;
                document.getElementById("txtUpdateUserName").value = sUserName;
                document.getElementById("txtUpdateUserLastName").value = sUserLastName;
                document.getElementById("txtUpdateUserImage").src = sUserImage;

            }
        });

        btnEditAccountNav.addEventListener("click", fillEditAccountInfo);

        function fillEditAccountInfo() {

            sUserEmailorPhoneNumber = sessionStorage.getItem('userName');
            sUserId = sessionStorage.getItem('userId');
            sUserName = sessionStorage.getItem('firstName');
            sUserLastName = sessionStorage.getItem('lastName');
            //sUserPassword = sessionStorage.getItem ( 'password' );
            sUserImage = sessionStorage.getItem('image');

            document.getElementById("txtEditAccountId").value = sUserId;
            document.getElementById("txtEditAccountEmailorPhoneNumber").value = sUserEmailorPhoneNumber;
            document.getElementById("txtEditAccountName").value = sUserName;
            document.getElementById("txtEditAccountLastName").value = sUserLastName;
            //document.getElementById( "txtEditAccountPassword" ).value = sUserPassword;
            document.getElementById("txtEditAccountImage").src = sUserImage;

        }

        btnDeleteAccountNav.addEventListener("click", fillDeleteAccountInfo);


        function fillDeleteAccountInfo() {

            sUserEmailorPhoneNumber = sessionStorage.getItem('userName');

            document.getElementById("txtDeleteAccountEmailorPhoneNumber").value = sUserEmailorPhoneNumber;

        }


        /************************************************************************/
        /************************************************************************/
        /************************************************************************/


        // Update product ADMIN
        btnUpdateProductForm.addEventListener("click", updateProduct);

        //editing products
        function updateProduct() {

            var request = new XMLHttpRequest();

            request.onreadystatechange = function () {
                if (this.readyState == 4 && this.status == 200) {

                    var ajProductDataFromServer = JSON.parse(this.responseText);
                    //console.log( "Response:" + ajProductDataFromServer) ;

                    if (ajProductDataFromServer.status == "ok") {

                        //console.log( "PRODUCT UPDATED IN THE DATABASE" );
                        pageUpdateProduct.style.display = "none";
                        showAdminInterface();
                        getProductData();

                    } else {

                        //console.log( "PRODUCT NOT UPDATED THE DATABASE" );
                        pageUpdateProduct.style.display = "flex";
                        lblUpdateProductErrorMessage.innerHTML = "";
                        var sUpdateProductErrorMessage = "Updating Product Failed - Try again";
                        lblUpdateProductErrorMessage.insertAdjacentHTML('beforeend', sUpdateProductErrorMessage);

                    }
                }
            }

            request.open("POST", "apis/api_edit_product.php", true);
            var jFrmUpdateProduct = new FormData(frmUpdateProduct);
            request.send(jFrmUpdateProduct);

        }


        /************************************************************************/
        /************************************************************************/
        /************************************************************************/

        // Update user ADMIN
        btnUpdateUserForm.addEventListener("click", updateUser);

        //editing users
        function updateUser() {

            var request = new XMLHttpRequest();

            request.onreadystatechange = function () {
                if (this.readyState == 4 && this.status == 200) {

                    var ajUserDataFromServer = JSON.parse(this.responseText);
                    //console.log( "Response:", ajUserDataFromServer );

                    if (ajUserDataFromServer.status == "ok") {

                        //console.log( "USER UPDATED IN THE DATABASE" );
                        pageUpdateUser.style.display = "none";
                        pageViewUsers.style.display = "flex";
                        getUserData();

                    } else {

                        //console.log( "USER NOT UPDATED IN THE DATABASE" );
                        pageUpdateUser.style.display = "flex";
                        //console.log( "USER NOT UPDATED IN THE DATABASE" );
                        lblUpdateUserErrorMessage.innerHTML = "";
                        var sUpdateUserErrorMessage = "Updating User Failed - Try again";
                        lblUpdateUserErrorMessage.insertAdjacentHTML('beforeend', sUpdateUserErrorMessage);

                    }
                }
            }

            request.open("POST", "apis/api_edit_user.php", true);
            var jFormUpdateUser = new FormData(frmUpdateUser);
            request.send(jFormUpdateUser);

        }

        /************************************************************************/
        /************************************************************************/
        /************************************************************************/


        // GLOBAL ARRAY for the storing any SUBSRIBER DATA from the SERVER  
        var ajSubscriberDataFromServer = [];

        // JSON OBEJCT for passing latitude and longtitude values from the map
        var jMarkerPos = {};

        /************************************************************************/
        /************************************************************************/
        /************************************************************************/

        btnSubscribeForm.addEventListener("click", saveSubscriber);


        function saveSubscriber() {

            var jFrmSubscriber = new FormData(frmSubscribe);
            jFrmSubscriber.append("lng", jMarkerPos.lng);
            jFrmSubscriber.append("lat", jMarkerPos.lat);


            var request = new XMLHttpRequest();
            request.onreadystatechange = function () {
                if (this.readyState == 4 && this.status == 200) {

                    var ajSubscriberDataFromServer = JSON.parse(this.responseText);
                    //console.log( "Response:", ajSubscriberDataFromServer );

                    if (ajSubscriberDataFromServer.status == "ok") {

                        //console.log( "SUBSCRIBE SUCCESFULL" );
                        pageSubscribe.style.display = "flex";
                        lblSubscribeErrorMessage.innerHTML = "";
                        var sSubscribeErrorMessage = "You have succesfully subscribed to our newletter!";
                        var sSubscribeErrorMessage = sSubscribeErrorMessage.fontcolor(" #549839");
                        lblSubscribeErrorMessage.insertAdjacentHTML('beforeend', sSubscribeErrorMessage);

                    } else {

                        //console.log( "SUBSCRIBE FAIL - TRY AGAIN" );
                        pageSubscribe.style.display = "flex";
                        lblSubscribeErrorMessage.innerHTML = "";
                        var sSubscribeErrorMessage = "Subscribtion failed - Try again";
                        lblSubscribeErrorMessage.insertAdjacentHTML('beforeend', sSubscribeErrorMessage);

                    }
                }
            }

            request.open("POST", "apis/api_save_subscriber.php", true);
            request.send(jFrmSubscriber);

        }


        /************************************************************************/
        /************************************************************************/
        /************************************************************************/

        function initMap() {
            // create the maps
            var jLocation = {
                zoom: 14,
                center: new google.maps.LatLng(55.703935, 12.537669)
            }
            // Map in the form, when subscribe
            mapinForm = new google.maps.Map(document.getElementById("mapinForm"), jLocation);
            // Map in the body, when displaying subscribers
            map = new google.maps.Map(document.getElementById("map"), jLocation);

            var marker = new google.maps.Marker({

                map: mapinForm

            });

            // TAKE lat & long on map CLICK
            mapinForm.addListener('click', function (e) {
                jMarkerPos.lng = e.latLng.lng();
                jMarkerPos.lat = e.latLng.lat();
                console.log(jMarkerPos);
                marker.setPosition(jMarkerPos);

            });

            // MAP action for displaying the locations
            setMarkers(map, ajSubscriberDataFromServer);

            function setMarkers(map, ajSubscriberDataFromServer) {
                var markerViewShopLocation, i;
                var markersViewShopsLocation = [];
                for (i = 0; i < ajSubscriberDataFromServer.length; i++) {
                    var locationLat = ajSubscriberDataFromServer[i].geoLocationLatitude;
                    var locationLng = ajSubscriberDataFromServer[i].geoLocationLongtitude;
                    var firstName = ajSubscriberDataFromServer[i].firstName;
                    var lastName = ajSubscriberDataFromServer[i].lastName;
                    latlngset = new google.maps.LatLng(locationLat, locationLng);

                    // MARKER for displaying location
                    var markerViewShopLocation = new google.maps.Marker({
                        position: latlngset,
                        map: map

                    });

                    // INFOWINDOW 
                    var infowindow = new google.maps.InfoWindow({
                        // no use filling in a content here
                    });

                    markersViewShopsLocation.push(markerViewShopLocation);

                    // INFOWINDOW action on MARKER mouseover
                    markerViewShopLocation.addListener('mouseover', function (e) {
                        var index = markersViewShopsLocation.indexOf(this);
                        var contentString = '<h3 style="font-weight: bold;">' + ajSubscriberDataFromServer[
                            index].firstName + " " + ajSubscriberDataFromServer[index].lastName + '</h3>';
                        infowindow.setContent(contentString);
                        infowindow.open(map, markersViewShopsLocation[index]);
                    });

                }
            }
        }

        /************************************************************************/
        /************************************************************************/
        /************************************************************************/


        // GET SUBSCRIBERS to display them on the page and on map 

        function getSubriberData() {
            var request = new XMLHttpRequest();
            request.onreadystatechange = function () {
                if (this.readyState == 4 && this.status == 200) {

                    ajSubscriberDataFromServer = JSON.parse(this.responseText);
                    //console.log( "Response:", ajSubscriberDataFromServer );


                    if (sessionStorage.getItem('userRole') === "admin") {
                        //console.log( "DISPLAY SUBSCRIBERS" );
                        showSubscribers();
                    }
                }
            }
            request.open("GET", "apis/api_get_subscribers.php", true);
            request.send();

        }

        /************************************************************************/
        /************************************************************************/
        /************************************************************************/

        // DISPLAY ALL subsribers dinamically using a loop and then INSERT into HTML and on the map
        function showSubscribers() {


            lblSubscriberList.innerHTML = "";

            for (var i = 0; i < ajSubscriberDataFromServer.length; i++) {

                var lblSubscriber = '<div class="lblSubscriber">' + '<h3 class="lblSubscriberId">' + 'Id:' + ' ' +
                    ajSubscriberDataFromServer[i].subscriberId + '</h3>' +
                    '<h3 class="lblSubscriberName" data-subscriberName="' + ajSubscriberDataFromServer[i].firstName +
                    '">' + 'Name:' + ' ' + ajSubscriberDataFromServer[i].firstName +
                    '<h3 class ="lblSubscriberLastName" data-subscriberLastName="' + ajSubscriberDataFromServer[i].lastName +
                    '">' + 'Lastname:' + ' ' + ajSubscriberDataFromServer[i].lastName + '</h3>' +
                    '<h3 class="lblSubscriberEmail" data-subscriberEmail="' + ajSubscriberDataFromServer[i].email +
                    '">' + 'Email:' + ' ' + ajSubscriberDataFromServer[i].email + '</h3>' + '</div>';

                //console.log(ajSubscriberDataFromServer[i].subscriberId);

                lblSubscriberList.insertAdjacentHTML('beforeend', lblSubscriber);

                showPages();

            }
        }

        /************************************************************************/
        /************************************************************************/
        /************************************************************************/
    </script>
    <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyA9B2bXFoPWTxOBsHs4d2FWqwp7GUlg--w&callback=initMap">
    </script>
</body>

</html>